@using Pnprpg.DomainService.Enums
@using Pnprpg.DomainService.Helpers
@model Pnprpg.DomainService.Models.TraitGroup
@{ Html.RenderAction("Wizard", "HeroGen", new { status = HeroGenStatus.Traits });}
<div class="h4 col-12">Выберите до @Constants.MaxTraitCount особенностей</div>
<div id="status" class="w-100"></div>
@foreach (var trait in Model.List)
{
    <div class="card col-10 col-md-5 col-md-3 smallForSmall m-1">

        <div class="card-header font-weight-bold">
            @trait.Name
            @if (Model.IsAssignable(trait))
            {
                <div class="badge ajax-btn pointer btn-success"
                     data-url="@Url.Action("ChooseTrait", "BackStory", new {trait.Id})">
                    +
                </div>
            }
            else if (trait.IsAssigned())
            {
                <div class="badge bg-success">✓</div>
            }
        </div>
        <div class="card-body">
            @foreach (var effect in trait.Effects)
            {
                var span = "<span class='badge alert-{0}'>{1}</span>";
                if (effect.Type == EffectType.Positive)
                {
                    span = string.Format(span, "success", $"+{effect.Value}");
                }
                else if (effect.Type == EffectType.Negative)
                {
                    span = string.Format(span, "danger", effect.Value);
                }
                else
                {
                    span = string.Format(span, "info", effect.Value);
                }
                <div>
                    @Html.Raw(effect.ToString(span))
                </div>
            }
        </div>
    </div>
}
<div class="col-12">
    <button class="btn btn-primary mw-260 m-1 ajax-btn" data-url="@Url.Action("ResetTraits", "BackStory")">
        ↺ Перераспределить
    </button>
    <button class="btn btn-success mw-260 m-1 ajax-btn" data-url="@Url.Action("AbilityEdit", "Ability")">
        ✓ Сохранить
    </button>
</div>
